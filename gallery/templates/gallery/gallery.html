{% extends 'gallery/base.html' %}
{% load static %}

{% block body %}

<section class="gallery-section">
  <!-- <h2>Our Gallery</h2> -->

<div class="gallery-container">

  <aside class="sidebar">
        <a 
        href="{% url 'gallery' %}" 
        class="{% if request.resolver_match.url_name == 'gallery' %}active{% endif %}"
        >All events</a>
        <a 
        href="{% url 'boys_gallery' %}"
        class="{% if request.resolver_match.url_name == 'boys_gallery' %}active{% endif %}"
        >NCC Army Boys</a>
        <a 
        href="{% url 'girls_gallery' %}"
        class="{% if request.resolver_match.url_name == 'girls_gallery' %}active{% endif %}"
        >NCC Army Girls</a>
        <a 
        href="{% url 'naval_gallery' %}"
        class="{% if request.resolver_match.url_name == 'naval_gallery' %}active{% endif %}"
        >NCC Naval</a>
  </aside>

  <div class="gallery-grid" id="galleryGrid">

    {% if images %}
      {% for image in images %}
        <div class="gallery-item">

          <img
            src="{{ image.image.url }}"
            alt="Gallery Image"
            data-desc="{{ image.title }}"
          >

        </div>
        
        {% endfor %}
        {% else %}
        <p>No images.</p>
        {% endif %}
      </div>
</div>
        
      <div class="lightbox" id="lightbox">
        <span class="close" onclick="closeLightbox()">×</span>
        <span class="prev" onclick="prevImage()">❮</span>
        <img id="lightboxImg" src="" alt="">
        <div class="description" id="imgDescription"></div>
        <span class="next" onclick="nextImage()">❯</span>
      </div>

  </section>
      
      <script>
        const galleryImages = document.querySelectorAll('#galleryGrid img');
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightboxImg');
        const imgDescription = document.getElementById('imgDescription');
        
        const imageData = Array.from(galleryImages).map(img => ({
          src: img.src,
          desc: img.getAttribute('data-desc')
        }));
        
        let currentIndex = 0;
        
    galleryImages.forEach((img, index) => {
      img.addEventListener('click', () => {
        currentIndex = index;
        showImage();
      });
    });

    function showImage() {
      lightboxImg.src = imageData[currentIndex].src;
      imgDescription.textContent = imageData[currentIndex].desc;
      lightbox.style.display = 'flex';
    }

    function closeLightbox() {
      lightbox.style.display = 'none';
    }

    function nextImage() {
      currentIndex = (currentIndex + 1) % imageData.length;
      showImage();
    }

    function prevImage() {
      currentIndex = (currentIndex - 1 + imageData.length) % imageData.length;
      showImage();
    }

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeLightbox();
      if (e.key === 'ArrowRight') nextImage();
      if (e.key === 'ArrowLeft') prevImage();
    });
  </script>

{% endblock body %}
